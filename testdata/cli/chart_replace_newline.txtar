# String literal with newline in replace produces invalid CUE whitespace.
# https://github.com/cue-exp/helm2cue/issues/31
exec helm2cue chart chartdir outdir
cmp stderr stderr.golden
! cmp outdir/test.cue expected/test.cue

-- chartdir/Chart.yaml --
apiVersion: v2
name: test-app
version: 0.1.0
-- chartdir/values.yaml --
host: example.com
-- chartdir/templates/test.yaml --
args:
  - --host={{ .Values.host | replace "\n" "," }}
-- stderr.golden --
converted 1/1 templates from test-app
-- expected/test.cue --
// Code generated by helm2cue; DO NOT EDIT.

package test_app

import "strings"

test: [{
	args: [
		"--host=\(strings.Replace(#values.host, "\n", ",", -1))",
	]
}]
